---
title: "In-Class Exercise 02"
author: "Bhairavi Vairavelu"
date: "Sep 02 2024"
date-modified: "last-modified"
execute:
  eval: true
  echo: true
  message: false
  freeze: true
format:
  html:
    grid:
      body-width: 1300px
      sidebar-width: 50px
      margin-width: 350px
    toc: true
    toc-depth: 5
    toc-location: right
---

## 1. Install R Packages

The code chunk below is used to install and launch R packages:

```{r}
pacman::p_load(sf, raster, spatstat, tmap, tidyverse)
```

Installing maptools:

```{r}
#| eval: false
install.packages("maptools", repos = "https://packagemanager.posit.co/cran/2023-10-13")
```

## 2. Load Data

```{r}
childcare_sf <- st_read("data/child-care-services-geojson.geojson") %>%
  st_transform(crs = 3414)
```

```{r}
sg_sf <- st_read(dsn = "data", layer="CostalOutline")
```

```{r}
mpsz_sf <- st_read(dsn = "data", 
                layer = "MP14_SUBZONE_WEB_PL")
```

## 3. Data Wrangling

```{r}
sg_sf <- mpsz_sf %>%
  st_union()
```

```{r}
sg_sf
```

```{r}
sg_sf3414 <- st_set_crs(sg_sf, 3414)
st_crs(sg_sf3414)
```

```{r}
sg_sf3414
```

## 4. Geospatial Data Wrangling

```{r}
childcare <- as_Spatial(childcare_sf)
childcare_sp <- as(childcare, "SpatialPoints")
childcare_ppp <- as.ppp(childcare_sf)
```

```{r}
sg_owin <- as.owin(sg_sf)
childcareSG_ppp = childcare_ppp[sg_owin]
childcareSG_ppp.km <- rescale.ppp(childcareSG_ppp, 1000, "km")
```

```{r}
kde_childcareSG_adaptive <- adaptive.density(childcareSG_ppp.km, method="kernel")
```

```{r}
gridded_kde_childcareSG_ad <- as(
  kde_childcareSG_adaptive,
  "SpatialGridDataFrame"
)
spplot(gridded_kde_childcareSG_ad)
```

```{r}
set.seed(1234)
```
